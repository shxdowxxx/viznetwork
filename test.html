<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>VizualNetwork - Unblocked Games</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- Firebase SDK -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getFirestore, collection, doc, getDoc, setDoc, updateDoc, query, orderBy, limit, onSnapshot, serverTimestamp, increment } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyC5WTlSgDx53gE7eqAdilWatRMvWt2DNJE",
      authDomain: "vizualnetwork-64003.firebaseapp.com",
      projectId: "vizualnetwork-64003",
      storageBucket: "vizualnetwork-64003.firebasestorage.app",
      messagingSenderId: "960206239805",
      appId: "1:960206239805:web:0070ab755a9b7390cbd254",
      measurementId: "G-RQ1XH5NQZ6"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const analytics = getAnalytics(app);

    // Make Firebase available globally
    window.firebase = { db, auth, serverTimestamp, increment, collection, doc, getDoc, setDoc, updateDoc, query, orderBy, limit, onSnapshot, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged };
  </script>

  <style>
    :root {
      --viz: #0F468B;
      --viz-600: #1356ab;
      --viz-300: #64a0ff;
      --ink: #0b1220;
      --panel: #0e1a2e;
      --edge: rgba(255,255,255,.08);
      --text: #d9e9ff;
      --muted: #8fb0d9;
      --radius: 20px;
      --speed: 300ms;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: var(--text);
      background: radial-gradient(1200px 600px at 70% -10%, rgba(100,160,255,.16), transparent 60%),
                  radial-gradient(900px 600px at -10% 10%, rgba(15,70,139,.25), transparent 50%),
                  linear-gradient(180deg, #0a1222 0%, #070c17 100%);
      min-height: 100dvh;
      overflow-x: hidden;
      position: relative;
    }

    /* ===== PARTICLE BACKGROUND ===== */
    canvas#particle-network {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    /* ===== Dynamic Island Navigation ===== */
    .nav-wrap {
      position: sticky;
      top: 20px;
      display: flex;
      justify-content: center;
      z-index: 50;
      margin-bottom: 40px;
      padding: 0 16px;
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      background: rgba(10,15,25,0.65);
      backdrop-filter: blur(25px) saturate(180%);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 999px;
      box-shadow: 
        0 8px 32px rgba(15,70,139,.3), 
        inset 0 1px 0 rgba(255,255,255,.1),
        0 0 0 1px rgba(100,160,255,.1);
      padding: 0 24px;
      height: 56px;
      min-width: 80px;
      transition: all 0.5s cubic-bezier(.25,.8,.25,1);
      overflow: hidden;
      cursor: pointer;
    }

    .nav:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 12px 40px rgba(15,70,139,.4), 
        inset 0 1px 0 rgba(255,255,255,.15),
        0 0 0 1px rgba(100,160,255,.2);
    }

    .nav-header {
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.4s cubic-bezier(.25,.8,.25,1);
    }

    .nav-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--viz-300);
      font-size: 24px;
      transition: all 0.3s ease;
    }

    .nav:hover .nav-logo {
      color: #fff;
      transform: scale(1.1);
      text-shadow: 0 0 20px rgba(100,160,255,.6);
    }

    .nav-label {
      font-weight: 700;
      font-size: 14px;
      color: var(--muted);
      opacity: 0;
      transform: translateX(-10px);
      transition: all 0.4s cubic-bezier(.25,.8,.25,1) 0.1s;
      letter-spacing: 0.5px;
    }

    .nav.open .nav-label {
      opacity: 1;
      transform: translateX(0);
    }

    .nav.open {
      min-width: min(95vw, 1000px);
      height: 88px;
      border-radius: 32px;
      justify-content: space-between;
      padding: 0 36px;
      background: rgba(10,15,25,0.75);
      border: 1px solid rgba(255,255,255,0.15);
    }

    .nav.open:hover {
      transform: translateY(-3px);
    }

    .nav-menu {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      transform: translateY(25px) scale(0.9);
      opacity: 0;
      pointer-events: none;
      transition: all 0.5s cubic-bezier(.25,.8,.25,1) 0.1s;
    }

    .nav.open .nav-menu {
      transform: translateY(0) scale(1);
      opacity: 1;
      pointer-events: auto;
    }

    .nav-tab {
      padding: 8px 14px;
      border-radius: 16px;
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(.25,.8,.25,1);
      cursor: pointer;
      text-decoration: none;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.08);
      white-space: nowrap;
    }

    .nav-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.1), transparent);
      transition: left 0.5s ease;
    }

    .nav-tab:hover::before {
      left: 100%;
    }

    .nav-tab:hover {
      background: var(--viz-300);
      color: #fff;
      box-shadow: 
        0 8px 25px rgba(100,160,255,.4),
        inset 0 1px 0 rgba(255,255,255,.2);
      transform: translateY(-3px) scale(1.05);
      border-color: rgba(255,255,255,.2);
    }

    .nav-tab.active {
      background: var(--viz);
      color: #fff;
      box-shadow: 
        0 6px 20px rgba(100,160,255,.5),
        inset 0 1px 0 rgba(255,255,255,.3);
      transform: translateY(-2px);
    }

    .nav-ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(100,160,255,.3);
      transform: scale(0);
      animation: ripple 0.6s linear;
      pointer-events: none;
    }

    @keyframes ripple {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    /* Tablet optimizations */
    @media (max-width: 1024px) {
      .nav-menu {
        gap: 12px;
      }
      
      .nav-tab {
        padding: 7px 12px;
        font-size: 12px;
      }
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      .nav-wrap {
        top: 10px;
        padding: 0 8px;
      }
      
      .nav {
        height: 50px;
        padding: 0 18px;
      }
      
      .nav.open {
        height: 75px;
        padding: 0 20px;
        min-width: calc(100vw - 16px);
      }
      
      .nav-menu {
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .nav-tab {
        padding: 6px 10px;
        font-size: 11px;
        border-radius: 12px;
      }
    }

    /* Small mobile optimizations */
    @media (max-width: 480px) {
      .nav.open {
        height: 70px;
        padding: 0 16px;
      }
      
      .nav-menu {
        gap: 8px;
      }
      
      .nav-tab {
        padding: 5px 8px;
        font-size: 10px;
        border-radius: 10px;
      }
      
      .nav-tab i {
        font-size: 10px !important;
        margin-right: 4px !important;
      }
    }

    /* ===== HEADER ===== */
    header {
      padding: 20px 16px 28px;
      text-align: center;
      position: relative;
    }

    .brand {
      font-family: Orbitron, Inter, sans-serif;
      text-transform: uppercase;
      letter-spacing: .25em;
      font-weight: 700;
      font-size: clamp(32px, 4vw, 48px);
      color: #fff;
      margin: 0;
    }

    .brand em {
      color: var(--viz-300);
      font-style: normal;
      text-shadow: 0 0 22px rgba(100,160,255,.35);
    }

    .tag {
      margin: 10px auto 0;
      max-width: 640px;
      color: var(--muted);
      font-weight: 500;
    }

    /* ===== HOLO EARTH ===== */
    .holo-earth {
      margin: 20px auto;
      width: 220px;
      height: 220px;
      position: relative;
      perspective: 1000px;
    }

    .holo-globe {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: relative;
      transform-style: preserve-3d;
      background: radial-gradient(circle at 30% 30%, #0a1e33 0%, #031020 70%);
      box-shadow: 0 0 30px rgba(100,160,255,0.4), inset 0 0 20px rgba(100,160,255,0.2);
      overflow: hidden;
      animation: spin 20s linear infinite;
    }

    .holo-globe::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: url("https://upload.wikimedia.org/wikipedia/commons/6/68/BlueMarble-2001-2002.png") no-repeat center/cover;
      mix-blend-mode: screen;
      opacity: 0.7;
    }

    .holo-globe::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: repeating-linear-gradient(transparent 0 2px, rgba(100,160,255,0.12) 2px 4px);
      mix-blend-mode: overlay;
      opacity: 0.3;
      animation: scan 6s linear infinite;
    }

    .holo-rim {
      position: absolute;
      inset: -10px;
      border-radius: 50%;
      box-shadow: 0 0 40px 15px rgba(100,160,255,0.25);
      pointer-events: none;
    }

    @keyframes spin {
      from { transform: rotateY(0deg); }
      to { transform: rotateY(360deg); }
    }

    @keyframes scan {
      from { background-position-y: 0; }
      to { background-position-y: 100%; }
    }

    /* ===== MAIN CONTENT ===== */
    .container {
      width: min(1200px, 92vw);
      margin: 24px auto 80px;
    }

    .card {
      background: rgba(255,255,255,.03);
      border: 1px solid var(--edge);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: 0 0 30px rgba(15,70,139,.25);
      margin-bottom: 20px;
    }
    .card h2 {
      margin: 0 0 8px;
      font: 700 20px/1.2 Orbitron, Inter, sans-serif;
      color: #fff;
    }

    /* ===== GAMES GRID ===== */
    .games-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .game-card {
      background: rgba(255,255,255,.03);
      border: 1px solid var(--edge);
      border-radius: var(--radius);
      overflow: hidden;
      transition: all var(--speed) ease;
      cursor: pointer;
    }
    .game-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(15,70,139,.35);
    }
    .game-thumb {
      width: 100%;
      height: 160px;
      background: linear-gradient(135deg, #0F468B, #64a0ff);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 40px;
    }
    .game-info { padding: 15px; }
    .game-title { font-weight: 700; margin: 0 0 8px; color: #fff; }
    .game-desc { color: var(--muted); font-size: 14px; margin: 0 0 15px; }
    .play-btn {
      display: block;
      width: 100%;
      padding: 10px;
      background: var(--viz);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      text-align: center;
      text-decoration: none;
      transition: all var(--speed) ease;
    }
    .play-btn:hover {
      background: var(--viz-600);
      transform: translateY(-2px);
    }

    /* ===== LOGIN MODAL ===== */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: rgba(10,15,25,0.95);
      border: 1px solid var(--edge);
      border-radius: 24px;
      padding: 40px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(15,70,139,.4);
      backdrop-filter: blur(20px);
      position: relative;
    }

    .modal-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .modal-title {
      font-family: Orbitron, sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: #fff;
      margin: 0 0 8px;
    }

    .modal-subtitle {
      color: var(--muted);
      font-size: 14px;
      margin: 0;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      color: var(--text);
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255,255,255,.05);
      border: 1px solid var(--edge);
      border-radius: 12px;
      color: var(--text);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--viz-300);
      box-shadow: 0 0 0 3px rgba(100,160,255,.1);
      background: rgba(255,255,255,.08);
    }

    .form-input::placeholder {
      color: var(--muted);
    }

    .btn-primary {
      width: 100%;
      padding: 12px;
      background: var(--viz);
      color: #fff;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 15px;
    }

    .btn-primary:hover {
      background: var(--viz-600);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(100,160,255,.4);
    }

    .btn-secondary {
      width: 100%;
      padding: 12px;
      background: transparent;
      color: var(--muted);
      border: 1px solid var(--edge);
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,.05);
      color: var(--text);
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--muted);
      font-size: 20px;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-modal:hover {
      color: #fff;
    }

    .form-switch {
      text-align: center;
      margin-top: 20px;
    }

    .form-switch a {
      color: var(--viz-300);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .form-switch a:hover {
      color: #fff;
    }

    /* ===== PROFILE PAGE ===== */
    .profile-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--viz), var(--viz-300));
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-size: 32px;
      color: #fff;
      box-shadow: 0 8px 25px rgba(100,160,255,.4);
    }

    .profile-username {
      font-family: Orbitron, sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: #fff;
      margin: 0 0 5px;
    }

    .profile-level {
      color: var(--viz-300);
      font-weight: 600;
      font-size: 16px;
    }

    .xp-bar-container {
      background: rgba(255,255,255,.1);
      border-radius: 20px;
      height: 12px;
      margin: 20px 0;
      overflow: hidden;
    }

    .xp-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--viz), var(--viz-300));
      border-radius: 20px;
      transition: width 0.5s ease;
      position: relative;
    }

    .xp-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.3), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }

    .xp-text {
      text-align: center;
      color: var(--muted);
      font-size: 14px;
      margin-top: 8px;
    }

    .badges-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .badge {
      background: rgba(255,255,255,.05);
      border: 1px solid var(--edge);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .badge.earned {
      background: rgba(100,160,255,.1);
      border-color: var(--viz-300);
      box-shadow: 0 4px 15px rgba(100,160,255,.2);
    }

    .badge-icon {
      font-size: 24px;
      margin-bottom: 8px;
      color: var(--muted);
    }

    .badge.earned .badge-icon {
      color: var(--viz-300);
    }

    .badge-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
      margin: 0;
    }

    .badge.earned .badge-name {
      color: #fff;
    }

    /* ===== LEADERBOARD ===== */
    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 15px;
      background: rgba(255,255,255,.03);
      border: 1px solid var(--edge);
      border-radius: 12px;
      margin-bottom: 10px;
      transition: all 0.3s ease;
    }

    .leaderboard-item:hover {
      background: rgba(255,255,255,.06);
      transform: translateY(-2px);
    }

    .leaderboard-rank {
      font-family: Orbitron, sans-serif;
      font-size: 18px;
      font-weight: 700;
      color: var(--viz-300);
      width: 40px;
      text-align: center;
    }

    .leaderboard-rank.top3 {
      color: #ffd700;
    }

    .leaderboard-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--viz), var(--viz-300));
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 15px;
      font-size: 16px;
      color: #fff;
    }

    .leaderboard-info {
      flex: 1;
    }

    .leaderboard-username {
      font-weight: 600;
      color: #fff;
      margin: 0 0 4px;
    }

    .leaderboard-level {
      font-size: 12px;
      color: var(--muted);
      margin: 0;
    }

    .leaderboard-xp {
      font-family: Orbitron, sans-serif;
      font-weight: 700;
      color: var(--viz-300);
      font-size: 16px;
    }

    /* ===== FIREBASE STATUS ===== */
    .firebase-status {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border: 1px solid var(--edge);
    }

    .firebase-status.connected {
      background: rgba(34,197,94,0.8);
      border-color: rgba(34,197,94,0.3);
    }

    .firebase-status.error {
      background: rgba(239,68,68,0.8);
      border-color: rgba(239,68,68,0.3);
    }

    .firebase-status.connecting {
      background: rgba(251,191,36,0.8);
      border-color: rgba(251,191,36,0.3);
    }

    /* ===== FOOTER ===== */
    footer {
      border-top: 1px solid var(--edge);
      padding: 20px;
      text-align: center;
      color: var(--muted);
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <!-- Background -->
  <canvas id="particle-network"></canvas>

  <!-- Firebase Status -->
  <div class="firebase-status" id="firebaseStatus">Connecting to Firebase...</div>

  <!-- Login Modal -->
  <div class="modal-overlay" id="loginModal">
    <div class="modal">
      <button class="close-modal" id="closeModal">&times;</button>
      <div class="modal-header">
        <h2 class="modal-title">Welcome to VizualNetwork</h2>
        <p class="modal-subtitle">Sign in to track your progress and compete with others!</p>
      </div>
      <form id="loginForm">
        <div class="form-group">
          <label class="form-label" for="loginUsername">Email</label>
          <input type="email" id="loginUsername" class="form-input" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="loginPassword">Password</label>
          <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="btn-primary">Sign In</button>
        <div class="form-switch">
          Don't have an account? <a href="#" id="showRegister">Create one</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Register Modal -->
  <div class="modal-overlay" id="registerModal">
    <div class="modal">
      <button class="close-modal" id="closeRegisterModal">&times;</button>
      <div class="modal-header">
        <h2 class="modal-title">Create Account</h2>
        <p class="modal-subtitle">Join the VizualNetwork community!</p>
      </div>
      <form id="registerForm">
        <div class="form-group">
          <label class="form-label" for="registerUsername">Username</label>
          <input type="text" id="registerUsername" class="form-input" placeholder="Choose a username" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="registerEmail">Email</label>
          <input type="email" id="registerEmail" class="form-input" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="registerPassword">Password</label>
          <input type="password" id="registerPassword" class="form-input" placeholder="Create a password" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="registerBio">Bio (Optional)</label>
          <input type="text" id="registerBio" class="form-input" placeholder="Tell us about yourself">
        </div>
        <button type="submit" class="btn-primary">Create Account</button>
        <div class="form-switch">
          Already have an account? <a href="#" id="showLogin">Sign in</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Dynamic Island Navigation -->
  <div class="nav-wrap">
    <div class="nav" id="nav">
      <div class="nav-header">
        <div class="nav-logo"><i class="fa-solid fa-gamepad"></i></div>
        <div class="nav-label">VizualNetwork</div>
      </div>
      <div class="nav-menu">
        <a href="#games" class="nav-tab">
          <i class="fa-solid fa-gamepad" style="margin-right: 8px;"></i>
          Games
        </a>
        <a href="#math" class="nav-tab">
          <i class="fa-solid fa-calculator" style="margin-right: 8px;"></i>
          Math
        </a>
        <a href="#biology" class="nav-tab">
          <i class="fa-solid fa-dna" style="margin-right: 8px;"></i>
          Biology
        </a>
        <a href="#profile" class="nav-tab" id="profileTab" style="display: none;">
          <i class="fa-solid fa-user" style="margin-right: 8px;"></i>
          Profile
        </a>
        <a href="#leaderboard" class="nav-tab" id="leaderboardTab" style="display: none;">
          <i class="fa-solid fa-trophy" style="margin-right: 8px;"></i>
          Leaderboard
        </a>
        <a href="#about" class="nav-tab">
          <i class="fa-solid fa-info-circle" style="margin-right: 8px;"></i>
          About
        </a>
        <div class="nav-tab" id="loginBtn" style="background: var(--viz); color: #fff;">
          <i class="fa-solid fa-sign-in-alt" style="margin-right: 8px;"></i>
          Login
        </div>
        <div class="nav-tab" id="userInfo" style="display: none; background: rgba(100,160,255,0.2);">
          <i class="fa-solid fa-user-circle" style="margin-right: 8px;"></i>
          <span id="usernameDisplay">User</span>
        </div>
      </div>
      <span class="nav-ripple"></span>
    </div>
  </div>

  <!-- Header -->
  <header>
    <h1 class="brand"><em>VIZUAL</em>NETWORK</h1>
    <div class="holo-earth">
      <div class="holo-globe"></div>
      <div class="holo-rim"></div>
    </div>
    <p class="tag">Play unblocked games anytime, anywhere. No downloads required.</p>
  </header>

  <!-- Main -->
  <main class="container">
    <section class="card" id="games">
      <h2>Game Collection</h2>
      <p>Browse our collection of unblocked games. All games are free to play!</p>
      <div class="games-grid" id="gamesGrid"></div>
    </section>

    <section class="card" id="math">
      <h2>Math Games & Tools</h2>
      <p>Interactive math games and educational tools to help you learn and practice mathematics. From basic arithmetic to advanced calculus, we have something for every level.</p>
      <div class="games-grid">
        <div class="game-card">
          <div class="game-thumb"><i class="fa-solid fa-calculator"></i></div>
          <div class="game-info">
            <h3 class="game-title">Math Calculator</h3>
            <p class="game-desc">Advanced calculator with graphing capabilities</p>
            <a href="#" class="play-btn">Open Calculator</a>
          </div>
        </div>
        <div class="game-card">
          <div class="game-thumb"><i class="fa-solid fa-chart-line"></i></div>
          <div class="game-info">
            <h3 class="game-title">Graphing Tool</h3>
            <p class="game-desc">Visualize mathematical functions and equations</p>
            <a href="#" class="play-btn">Start Graphing</a>
          </div>
        </div>
      </div>
    </section>

    <section class="card" id="biology">
      <h2>Biology Learning Center</h2>
      <p>Explore the fascinating world of biology through interactive simulations, virtual labs, and educational games. Perfect for students and biology enthusiasts.</p>
      <div class="games-grid">
        <div class="game-card">
          <div class="game-thumb"><i class="fa-solid fa-dna"></i></div>
          <div class="game-info">
            <h3 class="game-title">DNA Simulator</h3>
            <p class="game-desc">Interactive DNA structure and replication simulation</p>
            <a href="#" class="play-btn">Explore DNA</a>
          </div>
        </div>
        <div class="game-card">
          <div class="game-thumb"><i class="fa-solid fa-microscope"></i></div>
          <div class="game-info">
            <h3 class="game-title">Virtual Microscope</h3>
            <p class="game-desc">Examine cells and microorganisms in detail</p>
            <a href="#" class="play-btn">Start Examining</a>
          </div>
        </div>
      </div>
    </section>

    <section class="card" id="profile">
      <h2>Your Profile</h2>
      <div class="profile-header">
        <div class="profile-avatar" id="profileAvatar">
          <i class="fa-solid fa-user"></i>
        </div>
        <h3 class="profile-username" id="profileUsername">Guest User</h3>
        <p class="profile-level" id="profileLevel">Level 1</p>
        <div class="xp-bar-container">
          <div class="xp-bar" id="xpBar" style="width: 0%"></div>
        </div>
        <div class="xp-text" id="xpText">0 / 100 XP</div>
      </div>
      <div>
        <h3 style="color: var(--viz-300); margin-bottom: 15px;">🏆 Badges</h3>
        <div class="badges-grid" id="badgesGrid">
          <div class="badge" data-badge="first-game">
            <div class="badge-icon"><i class="fa-solid fa-play"></i></div>
            <p class="badge-name">First Game</p>
          </div>
          <div class="badge" data-badge="level-5">
            <div class="badge-icon"><i class="fa-solid fa-star"></i></div>
            <p class="badge-name">Level 5</p>
          </div>
          <div class="badge" data-badge="math-master">
            <div class="badge-icon"><i class="fa-solid fa-calculator"></i></div>
            <p class="badge-name">Math Master</p>
          </div>
          <div class="badge" data-badge="biology-expert">
            <div class="badge-icon"><i class="fa-solid fa-dna"></i></div>
            <p class="badge-name">Biology Expert</p>
          </div>
          <div class="badge" data-badge="streak-7">
            <div class="badge-icon"><i class="fa-solid fa-fire"></i></div>
            <p class="badge-name">7 Day Streak</p>
          </div>
          <div class="badge" data-badge="top-10">
            <div class="badge-icon"><i class="fa-solid fa-trophy"></i></div>
            <p class="badge-name">Top 10</p>
          </div>
        </div>
      </div>
    </section>

    <section class="card" id="leaderboard">
      <h2>Leaderboard</h2>
      <p>Compete with other players and climb the ranks!</p>
      <div id="leaderboardList">
        <div class="leaderboard-item">
          <div class="leaderboard-rank top3">1</div>
          <div class="leaderboard-avatar"><i class="fa-solid fa-crown"></i></div>
          <div class="leaderboard-info">
            <h4 class="leaderboard-username">Loading...</h4>
            <p class="leaderboard-level">Level 0</p>
          </div>
          <div class="leaderboard-xp">0 XP</div>
        </div>
      </div>
    </section>

    <section class="card" id="about">
      <h2>About VizualNetwork</h2>
      <p>We provide a collection of fun, unblocked games and educational tools that you can play at school, work, or anywhere else. Our platform is carefully designed to work on all devices without requiring downloads or installations.</p>
      <div style="margin-top: 20px; padding: 20px; background: rgba(100,160,255,0.1); border-radius: 12px; border-left: 4px solid var(--viz-300);">
        <h3 style="margin: 0 0 10px; color: var(--viz-300);">✨ Features</h3>
        <ul style="margin: 0; padding-left: 20px; color: var(--muted);">
          <li>No downloads required - play instantly in your browser</li>
          <li>Works on all devices - desktop, tablet, and mobile</li>
          <li>School and work friendly - no blocked content</li>
          <li>Regular updates with new games and tools</li>
          <li>Educational content for learning and development</li>
          <li>User accounts with progress tracking and XP system</li>
          <li>Leaderboards and badges for competition</li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2024 VizualNetwork. All rights reserved.</p>
    <p>All games are the property of their respective owners.</p>
  </footer>

  <!-- Scripts -->
  <script>
    // ===== FIREBASE USER MANAGEMENT SYSTEM =====
    class FirebaseUserSystem {
      constructor() {
        this.currentUser = null;
        this.userData = null;
        this.init();
      }

      init() {
        this.setupEventListeners();
        this.setupAuthListener();
        this.setupFirestoreListeners();
      }

      setupAuthListener() {
        if (window.firebase) {
          window.firebase.onAuthStateChanged(async (user) => {
            if (user) {
              this.currentUser = user;
              await this.loadUserData();
              this.updateUI();
              this.updateFirebaseStatus('Connected to Firebase', 'connected');
            } else {
              this.currentUser = null;
              this.userData = null;
              this.updateUI();
              this.updateFirebaseStatus('Not connected', 'error');
            }
          });
        } else {
          // Fallback to localStorage if Firebase not loaded
          this.setupLocalStorageFallback();
        }
      }

      setupLocalStorageFallback() {
        this.updateFirebaseStatus('Using local storage (offline mode)', 'connecting');
        // Keep the old localStorage system as fallback
        this.users = this.loadUsers();
        this.checkLoginStatus();
        this.updateUI();
      }

      loadUsers() {
        const stored = localStorage.getItem('vizualNetworkUsers');
        return stored ? JSON.parse(stored) : [];
      }

      async loadUserData() {
        if (!this.currentUser || !window.firebase) return;

        try {
          const userDoc = await window.firebase.getDoc(window.firebase.doc(window.firebase.collection(window.firebase.db, 'users'), this.currentUser.uid));
          
          if (userDoc.exists()) {
            this.userData = userDoc.data();
            this.updateUserDisplay();
          } else {
            // Create new user document
            await this.createUserDocument();
          }
        } catch (error) {
          console.error('Error loading user data:', error);
          this.updateFirebaseStatus('Error loading data', 'error');
        }
      }

      async createUserDocument() {
        if (!this.currentUser || !window.firebase) return;

        const userData = {
          username: this.currentUser.displayName || this.currentUser.email.split('@')[0],
          email: this.currentUser.email,
          bio: '',
          xp: 0,
          level: 1,
          badges: [],
          gamesPlayed: 0,
          mathGamesPlayed: 0,
          biologyGamesPlayed: 0,
          joinDate: window.firebase.serverTimestamp(),
          lastLogin: window.firebase.serverTimestamp()
        };

        try {
          await window.firebase.setDoc(
            window.firebase.doc(window.firebase.collection(window.firebase.db, 'users'), this.currentUser.uid),
            userData
          );
          this.userData = userData;
          this.updateUserDisplay();
        } catch (error) {
          console.error('Error creating user document:', error);
        }
      }

      async register(email, password, username, bio = '') {
        if (!window.firebase) {
          throw new Error('Firebase not available');
        }

        try {
          const userCredential = await window.firebase.createUserWithEmailAndPassword(window.firebase.auth, email, password);
          this.currentUser = userCredential.user;
          
          // Update display name
          await this.currentUser.updateProfile({
            displayName: username
          });

          // Create user document
          await this.createUserDocument();
          
          this.updateFirebaseStatus('Account created successfully!', 'connected');
          return userCredential.user;
        } catch (error) {
          throw new Error(error.message);
        }
      }

      async login(email, password) {
        if (!window.firebase) {
          throw new Error('Firebase not available');
        }

        try {
          const userCredential = await window.firebase.signInWithEmailAndPassword(window.firebase.auth, email, password);
          this.currentUser = userCredential.user;
          this.updateFirebaseStatus('Signed in successfully!', 'connected');
          return userCredential.user;
        } catch (error) {
          throw new Error(error.message);
        }
      }

      async logout() {
        if (window.firebase) {
          await window.firebase.signOut(window.firebase.auth);
        } else {
          this.currentUser = null;
          this.userData = null;
          this.updateUI();
        }
      }

      async addXP(amount, source = 'game') {
        if (!this.currentUser) return;

        if (window.firebase && this.userData) {
          try {
            // Update XP in Firebase
            await window.firebase.updateDoc(
              window.firebase.doc(window.firebase.collection(window.firebase.db, 'users'), this.currentUser.uid),
              {
                xp: window.firebase.increment(amount),
                lastLogin: window.firebase.serverTimestamp()
              }
            );

            // Update local data
            this.userData.xp += amount;
            
            // Check for level up
            const newLevel = this.calculateLevel(this.userData.xp);
            if (newLevel > this.userData.level) {
              this.userData.level = newLevel;
              await window.firebase.updateDoc(
                window.firebase.doc(window.firebase.collection(window.firebase.db, 'users'), this.currentUser.uid),
                { level: newLevel }
              );
              this.showLevelUpNotification(newLevel);
            }

            // Check for badges
            this.checkBadges();
            this.updateUserDisplay();
          } catch (error) {
            console.error('Error adding XP:', error);
          }
        } else {
          // Fallback to localStorage
          this.userData.xp += amount;
          const newLevel = this.calculateLevel(this.userData.xp);
          if (newLevel > this.userData.level) {
            this.userData.level = newLevel;
            this.showLevelUpNotification(newLevel);
          }
          this.checkBadges();
          this.updateUserDisplay();
        }
      }

      calculateLevel(xp) {
        return Math.floor(xp / 100) + 1;
      }

      getXPForLevel(level) {
        return (level - 1) * 100;
      }

      getXPProgress() {
        if (!this.userData) return { current: 0, needed: 100, percentage: 0 };
        
        const currentLevelXP = this.getXPForLevel(this.userData.level);
        const nextLevelXP = this.getXPForLevel(this.userData.level + 1);
        const currentXP = this.userData.xp - currentLevelXP;
        const neededXP = nextLevelXP - currentLevelXP;
        const percentage = (currentXP / neededXP) * 100;

        return { current: currentXP, needed: neededXP, percentage: Math.min(percentage, 100) };
      }

      setupFirestoreListeners() {
        if (!window.firebase) return;

        // Real-time leaderboard updates
        const leaderboardQuery = window.firebase.query(
          window.firebase.collection(window.firebase.db, 'users'),
          window.firebase.orderBy('xp', 'desc'),
          window.firebase.limit(10)
        );

        window.firebase.onSnapshot(leaderboardQuery, (snapshot) => {
          this.updateLeaderboard(snapshot.docs);
        });
      }

      updateLeaderboard(userDocs) {
        const leaderboardList = document.getElementById('leaderboardList');
        if (!leaderboardList) return;

        leaderboardList.innerHTML = userDocs.map((doc, index) => {
          const user = doc.data();
          return `
            <div class="leaderboard-item">
              <div class="leaderboard-rank ${index < 3 ? 'top3' : ''}">${index + 1}</div>
              <div class="leaderboard-avatar">
                <i class="fa-solid ${index === 0 ? 'fa-crown' : 'fa-user'}"></i>
              </div>
              <div class="leaderboard-info">
                <h4 class="leaderboard-username">${user.username}</h4>
                <p class="leaderboard-level">Level ${user.level}</p>
              </div>
              <div class="leaderboard-xp">${user.xp} XP</div>
            </div>
          `;
        }).join('');
      }

      updateUserDisplay() {
        if (!this.userData) return;

        const usernameEl = document.getElementById('profileUsername');
        const levelEl = document.getElementById('profileLevel');
        const xpBarEl = document.getElementById('xpBar');
        const xpTextEl = document.getElementById('xpText');

        if (usernameEl) usernameEl.textContent = this.userData.username;
        if (levelEl) levelEl.textContent = `Level ${this.userData.level}`;
        
        const xpProgress = this.getXPProgress();
        if (xpBarEl) xpBarEl.style.width = `${xpProgress.percentage}%`;
        if (xpTextEl) xpTextEl.textContent = `${xpProgress.current} / ${xpProgress.needed} XP`;

        // Update badges
        document.querySelectorAll('.badge').forEach(badge => {
          const badgeId = badge.dataset.badge;
          if (this.userData.badges.includes(badgeId)) {
            badge.classList.add('earned');
          } else {
            badge.classList.remove('earned');
          }
        });
      }

      updateFirebaseStatus(message, type = 'info') {
        const status = document.getElementById('firebaseStatus');
        if (status) {
          status.textContent = message;
          status.className = `firebase-status ${type}`;
        }
      }

      checkBadges() {
        if (!this.currentUser) return;

        const badges = [
          { id: 'first-game', condition: () => this.currentUser.gamesPlayed >= 1 },
          { id: 'level-5', condition: () => this.currentUser.level >= 5 },
          { id: 'math-master', condition: () => this.currentUser.mathGamesPlayed >= 10 },
          { id: 'biology-expert', condition: () => this.currentUser.biologyGamesPlayed >= 10 },
          { id: 'streak-7', condition: () => this.getStreakDays() >= 7 },
          { id: 'top-10', condition: () => this.getUserRank() <= 10 }
        ];

        badges.forEach(badge => {
          if (!this.currentUser.badges.includes(badge.id) && badge.condition()) {
            this.currentUser.badges.push(badge.id);
            this.showBadgeNotification(badge.id);
          }
        });
      }

      getStreakDays() {
        // Simplified - in real app, track daily logins
        return Math.floor(this.currentUser.xp / 50);
      }

      getUserRank() {
        const sortedUsers = [...this.users].sort((a, b) => b.xp - a.xp);
        return sortedUsers.findIndex(u => u.id === this.currentUser.id) + 1;
      }

      showLevelUpNotification(level) {
        // Create notification
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed; top: 20px; right: 20px; z-index: 1001;
          background: linear-gradient(135deg, var(--viz), var(--viz-300));
          color: white; padding: 15px 20px; border-radius: 12px;
          box-shadow: 0 8px 25px rgba(100,160,255,.4);
          font-weight: 600; animation: slideIn 0.5s ease;
        `;
        notification.innerHTML = `🎉 Level Up! You're now level ${level}!`;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.5s ease';
          setTimeout(() => notification.remove(), 500);
        }, 3000);
      }

      showBadgeNotification(badgeId) {
        const badgeNames = {
          'first-game': 'First Game',
          'level-5': 'Level 5',
          'math-master': 'Math Master',
          'biology-expert': 'Biology Expert',
          'streak-7': '7 Day Streak',
          'top-10': 'Top 10'
        };

        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed; top: 20px; right: 20px; z-index: 1001;
          background: linear-gradient(135deg, #ffd700, #ffed4e);
          color: #333; padding: 15px 20px; border-radius: 12px;
          box-shadow: 0 8px 25px rgba(255,215,0,.4);
          font-weight: 600; animation: slideIn 0.5s ease;
        `;
        notification.innerHTML = `🏆 Badge Earned: ${badgeNames[badgeId]}!`;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.5s ease';
          setTimeout(() => notification.remove(), 500);
        }, 3000);
      }

      updateUI() {
        const loginBtn = document.getElementById('loginBtn');
        const userInfo = document.getElementById('userInfo');
        const usernameDisplay = document.getElementById('usernameDisplay');
        const profileTab = document.getElementById('profileTab');
        const leaderboardTab = document.getElementById('leaderboardTab');

        if (this.currentUser) {
          loginBtn.style.display = 'none';
          userInfo.style.display = 'flex';
          usernameDisplay.textContent = this.currentUser.username;
          profileTab.style.display = 'flex';
          leaderboardTab.style.display = 'flex';
          this.updateProfile();
        } else {
          loginBtn.style.display = 'flex';
          userInfo.style.display = 'none';
          profileTab.style.display = 'none';
          leaderboardTab.style.display = 'none';
        }
      }

      updateProfile() {
        if (!this.currentUser) return;

        document.getElementById('profileUsername').textContent = this.currentUser.username;
        document.getElementById('profileLevel').textContent = `Level ${this.currentUser.level}`;
        
        const xpProgress = this.getXPProgress();
        document.getElementById('xpBar').style.width = `${xpProgress.percentage}%`;
        document.getElementById('xpText').textContent = `${xpProgress.current} / ${xpProgress.needed} XP`;

        // Update badges
        document.querySelectorAll('.badge').forEach(badge => {
          const badgeId = badge.dataset.badge;
          if (this.currentUser.badges.includes(badgeId)) {
            badge.classList.add('earned');
          } else {
            badge.classList.remove('earned');
          }
        });
      }

      updateLeaderboard() {
        const leaderboardList = document.getElementById('leaderboardList');
        const sortedUsers = [...this.users].sort((a, b) => b.xp - a.xp).slice(0, 10);
        
        leaderboardList.innerHTML = sortedUsers.map((user, index) => `
          <div class="leaderboard-item">
            <div class="leaderboard-rank ${index < 3 ? 'top3' : ''}">${index + 1}</div>
            <div class="leaderboard-avatar">
              <i class="fa-solid ${index === 0 ? 'fa-crown' : 'fa-user'}"></i>
            </div>
            <div class="leaderboard-info">
              <h4 class="leaderboard-username">${user.username}</h4>
              <p class="leaderboard-level">Level ${user.level}</p>
            </div>
            <div class="leaderboard-xp">${user.xp} XP</div>
          </div>
        `).join('');
      }

      setupEventListeners() {
        // Login modal
        document.getElementById('loginBtn').addEventListener('click', () => {
          document.getElementById('loginModal').classList.add('active');
        });

        document.getElementById('closeModal').addEventListener('click', () => {
          document.getElementById('loginModal').classList.remove('active');
        });

        document.getElementById('showRegister').addEventListener('click', (e) => {
          e.preventDefault();
          document.getElementById('loginModal').classList.remove('active');
          document.getElementById('registerModal').classList.add('active');
        });

        // Register modal
        document.getElementById('closeRegisterModal').addEventListener('click', () => {
          document.getElementById('registerModal').classList.remove('active');
        });

        document.getElementById('showLogin').addEventListener('click', (e) => {
          e.preventDefault();
          document.getElementById('registerModal').classList.remove('active');
          document.getElementById('loginModal').classList.add('active');
        });

        // Forms
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
          e.preventDefault();
          const email = document.getElementById('loginUsername').value; // Using email for Firebase
          const password = document.getElementById('loginPassword').value;
          
          try {
            await this.login(email, password);
            document.getElementById('loginModal').classList.remove('active');
            this.showNotification('Welcome back!', 'success');
          } catch (error) {
            this.showNotification(error.message, 'error');
          }
        });

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
          e.preventDefault();
          const username = document.getElementById('registerUsername').value;
          const email = document.getElementById('registerEmail').value;
          const password = document.getElementById('registerPassword').value;
          const bio = document.getElementById('registerBio').value;
          
          try {
            await this.register(email, password, username, bio);
            document.getElementById('registerModal').classList.remove('active');
            this.showNotification('Account created successfully!', 'success');
          } catch (error) {
            this.showNotification(error.message, 'error');
          }
        });

        // Logout
        document.getElementById('userInfo').addEventListener('click', () => {
          this.logout();
          this.showNotification('Logged out successfully', 'info');
        });

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
          overlay.addEventListener('click', (e) => {
            if (e.target === overlay) {
              overlay.classList.remove('active');
            }
          });
        });
      }

      checkLoginStatus() {
        const savedUserId = localStorage.getItem('currentUserId');
        if (savedUserId) {
          const user = this.users.find(u => u.id === savedUserId);
          if (user) {
            this.currentUser = user;
          }
        }
      }

      showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        const colors = {
          success: 'linear-gradient(135deg, #10b981, #34d399)',
          error: 'linear-gradient(135deg, #ef4444, #f87171)',
          info: 'linear-gradient(135deg, var(--viz), var(--viz-300))'
        };
        
        notification.style.cssText = `
          position: fixed; top: 20px; right: 20px; z-index: 1001;
          background: ${colors[type]}; color: white; padding: 15px 20px;
          border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,.2);
          font-weight: 600; animation: slideIn 0.5s ease;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.5s ease';
          setTimeout(() => notification.remove(), 500);
        }, 3000);
      }
    }

    // Initialize Firebase user system
    const userSystem = new FirebaseUserSystem();

    // Enhanced Dynamic Island Navigation
    const nav = document.getElementById('nav');
    const navTabs = document.querySelectorAll('.nav-tab');
    let isOpen = false;

    // Create ripple element if it doesn't exist
    let ripple = nav.querySelector('.nav-ripple');
    if (!ripple) {
      ripple = document.createElement('span');
      ripple.className = 'nav-ripple';
      nav.appendChild(ripple);
    }

    // Toggle navigation with enhanced animations
    nav.addEventListener('click', (e) => {
      e.preventDefault();
      isOpen = !isOpen;
      nav.classList.toggle('open', isOpen);
      
      // Create ripple effect
      const rect = nav.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = `${e.clientX - rect.left - size / 2}px`;
      ripple.style.top = `${e.clientY - rect.top - size / 2}px`;
      
      // Trigger ripple animation
      ripple.style.animation = 'none';
      ripple.offsetHeight; // Force reflow
      ripple.style.animation = 'ripple 0.6s linear';
    });

    // Smooth scrolling for navigation tabs
    navTabs.forEach(tab => {
      tab.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = tab.getAttribute('href');
        
        if (targetId.startsWith('#')) {
          const targetElement = document.querySelector(targetId);
          if (targetElement) {
            // Close navigation on mobile after clicking
            if (window.innerWidth <= 768) {
              nav.classList.remove('open');
              isOpen = false;
            }
            
            // Smooth scroll to target
            targetElement.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
            
            // Update active tab
            updateActiveTab(tab);
          }
        }
      });
    });

    // Update active tab based on scroll position
    function updateActiveTab(activeTab) {
      navTabs.forEach(tab => {
        tab.classList.remove('active');
      });
      if (activeTab) {
        activeTab.classList.add('active');
      }
    }

    // Scroll spy - highlight active section
    function handleScrollSpy() {
      const sections = document.querySelectorAll('section[id]');
      const scrollPos = window.scrollY + 100;

      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        const sectionId = section.getAttribute('id');

        if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
          const correspondingTab = document.querySelector(`.nav-tab[href="#${sectionId}"]`);
          updateActiveTab(correspondingTab);
        }
      });
    }

    // Throttled scroll handler
    let scrollTimeout;
    window.addEventListener('scroll', () => {
      if (scrollTimeout) {
        clearTimeout(scrollTimeout);
      }
      scrollTimeout = setTimeout(handleScrollSpy, 10);
    });

    // Close navigation when clicking outside
    document.addEventListener('click', (e) => {
      if (isOpen && !nav.contains(e.target)) {
        nav.classList.remove('open');
        isOpen = false;
      }
    });

    // Handle escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && isOpen) {
        nav.classList.remove('open');
        isOpen = false;
      }
    });

    // Initialize active tab on page load
    handleScrollSpy();

    // ===== GAME INTERACTION SYSTEM =====
    class GameSystem {
      constructor() {
        this.setupGameInteractions();
      }

      setupGameInteractions() {
        // Add XP when clicking play buttons
        document.addEventListener('click', (e) => {
          if (e.target.classList.contains('play-btn')) {
            this.handleGameClick(e.target);
          }
        });

        // Add XP for navigation interactions
        document.addEventListener('click', (e) => {
          if (e.target.closest('.nav-tab')) {
            this.handleNavigationClick(e.target.closest('.nav-tab'));
          }
        });
      }

      handleGameClick(button) {
        if (!userSystem.currentUser) {
          userSystem.showNotification('Please login to earn XP!', 'info');
          return;
        }

        const gameCard = button.closest('.game-card');
        const gameTitle = gameCard.querySelector('.game-title').textContent;
        
        // Determine game category and add appropriate XP
        if (gameTitle.includes('Calculator') || gameTitle.includes('Graphing')) {
          userSystem.currentUser.mathGamesPlayed++;
          userSystem.addXP(15, 'math');
          userSystem.showNotification(`+15 XP for playing ${gameTitle}!`, 'success');
        } else if (gameTitle.includes('DNA') || gameTitle.includes('Microscope')) {
          userSystem.currentUser.biologyGamesPlayed++;
          userSystem.addXP(15, 'biology');
          userSystem.showNotification(`+15 XP for playing ${gameTitle}!`, 'success');
        } else {
          userSystem.currentUser.gamesPlayed++;
          userSystem.addXP(10, 'game');
          userSystem.showNotification(`+10 XP for playing ${gameTitle}!`, 'success');
        }
      }

      handleNavigationClick(tab) {
        if (!userSystem.currentUser) return;

        // Add small XP for exploring different sections
        const href = tab.getAttribute('href');
        if (href && href.startsWith('#')) {
          userSystem.addXP(2, 'navigation');
        }
      }

      // Simulate game completion (for demo purposes)
      simulateGameCompletion(gameType) {
        if (!userSystem.currentUser) return;

        const xpRewards = {
          'math': 25,
          'biology': 25,
          'game': 20
        };

        const xp = xpRewards[gameType] || 15;
        userSystem.addXP(xp, gameType);
        userSystem.showNotification(`+${xp} XP for completing the game!`, 'success');
      }
    }

    // Initialize game system
    const gameSystem = new GameSystem();

    // Demo function to add sample users and XP
    function addDemoData() {
      if (userSystem.users.length === 0) {
        // Add some demo users
        const demoUsers = [
          { username: 'GameMaster', email: 'gamer@demo.com', password: 'demo123', bio: 'Professional gamer' },
          { username: 'MathWiz', email: 'math@demo.com', password: 'demo123', bio: 'Math enthusiast' },
          { username: 'BioExpert', email: 'bio@demo.com', password: 'demo123', bio: 'Biology student' },
          { username: 'NewPlayer', email: 'new@demo.com', password: 'demo123', bio: 'Just getting started' }
        ];

        demoUsers.forEach((userData, index) => {
          try {
            const user = userSystem.register(userData.username, userData.email, userData.password, userData.bio);
            // Add some demo XP
            user.xp = (index + 1) * 150;
            user.level = userSystem.calculateLevel(user.xp);
            user.gamesPlayed = (index + 1) * 5;
            user.mathGamesPlayed = (index + 1) * 3;
            user.biologyGamesPlayed = (index + 1) * 2;
            
            // Add some badges
            if (user.gamesPlayed >= 1) user.badges.push('first-game');
            if (user.level >= 5) user.badges.push('level-5');
            if (user.mathGamesPlayed >= 10) user.badges.push('math-master');
            if (user.biologyGamesPlayed >= 10) user.badges.push('biology-expert');
          } catch (e) {
            console.log('Demo user already exists:', userData.username);
          }
        });

        userSystem.saveUsers();
        userSystem.updateLeaderboard();
      }
    }

    // Add demo data on page load
    addDemoData();

    // Particles
    const canvas = document.getElementById('particle-network');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      initParticles();
    }
    function initParticles() {
      particles = [];
      const count = Math.floor((canvas.width * canvas.height) / 15000);
      for (let i=0;i<count;i++){
        particles.push({
          x: Math.random()*canvas.width,
          y: Math.random()*canvas.height,
          size: Math.random()*2+0.5,
          speedX: Math.random()*0.5-0.25,
          speedY: Math.random()*0.5-0.25,
          color: `rgba(100,160,255,${Math.random()*0.3+0.1})`
        });
      }
    }
    function drawParticles() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for (let i=0;i<particles.length;i++){
        for (let j=i+1;j<particles.length;j++){
          const dx=particles[i].x-particles[j].x;
          const dy=particles[i].y-particles[j].y;
          const dist=Math.sqrt(dx*dx+dy*dy);
          if(dist<100){
            ctx.beginPath();
            ctx.strokeStyle=`rgba(100,160,255,${0.2-dist/500})`;
            ctx.lineWidth=0.5;
            ctx.moveTo(particles[i].x,particles[i].y);
            ctx.lineTo(particles[j].x,particles[j].y);
            ctx.stroke();
          }
        }
        ctx.beginPath();
        ctx.arc(particles[i].x,particles[i].y,particles[i].size,0,Math.PI*2);
        ctx.fillStyle=particles[i].color;
        ctx.fill();
        particles[i].x+=particles[i].speedX;
        particles[i].y+=particles[i].speedY;
        if(particles[i].x<0||particles[i].x>canvas.width)particles[i].speedX*=-1;
        if(particles[i].y<0||particles[i].y>canvas.height)particles[i].speedY*=-1;
      }
      requestAnimationFrame(drawParticles);
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    drawParticles();
  </script>
</body>
</html>
